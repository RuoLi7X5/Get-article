# Novel Scraper & Saver

这是一个用于 Edge（Chromium）浏览器的扩展模板，用来抓取小说章节并保存到本地 TXT 文件。

功能

- 在当前标签页中尝试抓取文章标题与正文（启发式选择器）
- 在弹出窗口预览与编辑抓取内容
- 将内容保存为 TXT（通过 downloads API）
- 整本抓取：自动识别章节列表，批量抓取并分卷下载
- **指定章节抓取**：支持灵活的章节选择语法，抓取指定章节并合并到一个文件
- 可配置的分卷大小、批量抓取参数和请求延时
- 实时进度显示：显示抓取进度条、当前状态和详细信息
- 抓取控制：支持暂停/继续和终止抓取任务

安装与调试（Edge）

1. 打开 Edge，进入 edge://extensions/
2. 打开右上角的“开发人员模式”。
3. 点击“加载已解压的扩展”，选择本仓库目录（包含 `manifest.json` 的目录）。
4. 在任意小说章节页面点击扩展图标，使用“抓取当前页”并点击“保存为 TXT”。
5. 使用"抓取整本"功能可以自动抓取整本小说并分卷下载。
6. 点击"设置"按钮可以配置分卷大小等参数。
7. 抓取过程中会显示实时进度，可以随时暂停/继续或终止任务。

注意与扩展性

- 抓取逻辑使用常见的选择器和段落聚合，针对特殊网站可能需要定制解析规则（可在 `popup.js` 中增加站点白名单或自定义 DOM 路径）。
- 当前版本不做反爬限制处理。请遵守目标站点的使用条款和版权要求，仅在合法范围内使用。

配置说明

**下载配置**

- **下载子文件夹**：在 Chrome 默认下载目录下创建子文件夹
  - 示例：设置"小说下载"，文件会保存到 `下载目录/小说下载/书名.txt`
  - 留空则直接保存到下载目录
- **清理多余空行**：自动清理文本中的多余空行，保持内容整洁（默认开启）

**如何下载到指定绝对路径（如 D:\VSCode）**

由于 Chrome 扩展安全限制，无法直接指定绝对路径。解决方案：

1. 打开 Chrome 设置 → 高级 → 下载内容
2. 将"位置"改为你想要的路径（如 D:\VSCode）
3. 这样所有下载都会保存到该目录
4. 如需子文件夹，在扩展设置中填写文件夹名称

**整本抓取配置**

- **每卷章节数**：整本抓取时，每多少章保存为一个 TXT 文件（默认 100 章）
- **批量抓取大小**：每次并发抓取的章节数（默认 50 章）
- **请求间隔**：批次间的延时，避免请求过于频繁（默认 150 毫秒）

指定章节抓取功能

支持灵活的章节选择语法，可以精确控制要抓取的章节：

**语法格式**

- `2-10`：抓取第 2 章到第 10 章
- `2,4,6-10`：抓取第 2 章、第 4 章、第 6 章到第 10 章
- `1,3,5,7`：抓取第 1、3、5、7 章
- `5-8,12,15-20`：抓取第 5-8 章、第 12 章、第 15-20 章

**使用方法**

1. 在小说目录页面点击"抓取指定章节"按钮
2. 在弹出的输入框中输入章节范围
3. 点击"开始抓取"，系统会自动抓取指定章节
4. 所有选中的章节会合并到一个 TXT 文件中下载

**特点**

- 自动合并：所有指定章节会按顺序合并到一个文件
- 智能文件名：自动生成包含章节范围的文件名（如：书名\_第 2,4,6-10 章.txt）
- 进度显示：实时显示抓取进度和章节信息
- 错误处理：如果某些章节抓取失败，会在文件中标注错误信息

进度控制功能

- **实时进度**：显示当前抓取进度百分比和状态信息
- **暂停/继续**：可以随时暂停抓取任务，稍后继续
- **终止任务**：可以完全停止当前的抓取任务
- **详细信息**：显示当前正在处理的章节和批次信息

下步建议

- 添加站点规则编辑器并保存到 `chrome.storage`
- 支持 EPUB/Markdown 导出
- 添加抓取历史记录和失败重试功能
